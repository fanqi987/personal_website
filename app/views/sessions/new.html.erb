<!DOCTYPE html>
<html>
<body>
<%= provide :sub_title, "登录" %>
<!-- banner-->
<%= provide :banner, 'login.png' %>
<div class="container">
  <div id="login_title">
    <p>用户登录 <span class="fas fa-sign-in-alt"></span></p>
  </div>
  <%= render 'shared/flash' %>
  <div class="login_content">
    <%= form_for(:session, url: login_url, method: :post) do |f| %>
      <%#= render 'shared/errors', object: @user %>
      <div class="form-group">
        <%= f.label :email, '邮箱名' %>
        <%= f.email_field :email, class: 'form-control', required: true %>
      </div>
      <div class="form-group">
        <%= f.label :password, '密码' %>
        <%= f.password_field :password, class: 'form-control', required: true %>
      </div>
      <%= f.label(:remember_me, class: "checkbox inline") do %>
        <%= f.check_box :remember_me %>
        &nbsp;<span>在这台设备上记录我</span>
      <% end %>
      <div class="row">
        <%= f.submit "登录", class: "btn btn-primary" %>
        <%= link_to('忘记密码？', new_password_reset_path, class: 'btn') %>
      </div>
    <% end %>
  </div>
</div>
</body>
<script>
    onDocumentContentReadyNotMenu(-1);
    // console.log($('div .alert-success').length);
    if ($('div .alert-success').length > 0) {
        console.log('成功登录');
        window.setTimeout(function () {
            <%#= p "我是登录页面的p"%>
            <%#= p session[:current_url] %>
            <% if session[:current_url] %>
            window.location.href = '<%= session[:current_url] %>';
            <% else %>
            window.location.href = '<%= root_path %>';
            <% end %>
            console.log("正在载入的url:  " + window.location.href);
        }, 3000);
    } else {
        console.log('准备登录页面....');
    }
</script>
</html>